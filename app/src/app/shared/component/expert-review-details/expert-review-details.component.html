<section class="section admin_add__user bg-blue">
  <div class="jakay-container">
    <ng-container *ngIf="!loading; else loader">
      <div class="back-to-page c-pointer d-flex">
        <span (click)="back()"><img src="assets/images/backarrow.svg" /></span>
        <div class="ms-3 section-header">
          <h3 class="mb-3 font-38 text-primary fw-semibold">
            {{
              expertReviewDetail?.order_id
                ? "Order Details with the Expert"
                : ("Expert Review Details" | translate)
            }}
          </h3>
          <p class="text-primary-light font-14">
            {{
              "It is important to review the total summary of the details since they are evidence made of your order request with the expert. Remember that it is important to confirm the payment made with the expert."
                | translate
            }}
          </p>
        </div>
      </div>
      <div class="row justify-content-between">
        <div class="d-flex justify-content-between mb-3 w-100 flex-wrap">
          <h3 class="text-primary font-24 pb-4 fw-semibold">
            {{ "Details" | translate }}
          </h3>
          <div class="d-flex ms-md-3 mt-3 mt-sm-0 ms-auto">
            <p
              class="label in-progress d-inline-block d-lg-block"
              *ngIf="expertReviewDetail.appraisal_report_status === 'in_pending' && expertReviewDetail.payment.status === 'success'">
              {{ "Appraisal Report Pending" | translate }}
            </p>
            <p
              class="label completed d-inline-block d-lg-block"
              *ngIf="expertReviewDetail.appraisal_report_status === 'completed'"
            >
              {{ "Appraisal Report Submitted" | translate }}
            </p>

            <p
            class="label cancelled d-inline-block d-lg-block"
            *ngIf="expertReviewDetail.appraisal_report_status === 'cancelled'"
          >
            {{ "Cancelled" | translate }}
          </p>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-6">
            <div class="row">
              <div class="col-12" *ngIf="expertReviewDetail.package_details">
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="font-24 fw-semibold text-primary mb-4">
                            {{ "Selected Service" | translate }}
                          </h3>
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-4 col-4">
                      <h3 class="font-16 text-primary mb-4">
                        {{
                          expertReviewDetail.package_details.package_name
                            ? (expertReviewDetail.package_details.package_name
                              | translate)
                            : "-"
                        }}
                      </h3>
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12"
                *ngIf="expertReviewDetail.vehicle_information"
              >
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="text-primary font-24 mb-2 fw-semibold">
                            {{ "Vehicle Information" | translate }}
                          </h3>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Make" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.vehicle_information.make
                              ? expertReviewDetail.vehicle_information.make
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Model" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.vehicle_information.model
                              ? expertReviewDetail.vehicle_information.model
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Year" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.vehicle_information.year
                              ? expertReviewDetail.vehicle_information.year
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div
                      class="col-lg-4 col-sm-6 col-12"
                      *ngIf="
                        expertReviewDetail?.order_id ||
                        expertReviewDetail?.vehicle_information?.is_insider ==
                          true
                      "
                    >
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Body Type" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.vehicle_information.body_type
                              ? expertReviewDetail.vehicle_information.body_type
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-4 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Number Plate" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.vehicle_information.number_plate
                              ? expertReviewDetail.vehicle_information
                                  .number_plate
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div
                      class="col-lg-4 col-sm-6 col-12"
                      *ngIf="
                        expertReviewDetail?.order_id ||
                        expertReviewDetail?.vehicle_information?.is_insider ==
                          true
                      "
                    >
                      <div class="form-group">
                        <label class="text-primary-light font-14 d-block mb-2"
                          >{{ "Price" | translate }} $</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          ${{
                            expertReviewDetail.vehicle_information.price
                              ? (expertReviewDetail.vehicle_information.price
                                | spanishNumber)
                              : "00.00"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-12 col-md-12 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Vehicle Source" | translate }}</label
                        >
                        <p
                          class="text-primary font-18 mb-0 fw-semibold"
                          *ngIf="
                            expertReviewDetail?.order_id ||
                            expertReviewDetail?.vehicle_information
                              ?.is_insider == true
                          "
                        >
                          {{ "Vehicle within the platform" | translate }}
                        </p>
                        <p
                          class="text-primary font-18 mb-0 fw-semibold"
                          *ngIf="
                            !expertReviewDetail?.order_id &&
                            expertReviewDetail?.vehicle_information
                              ?.is_insider == false
                          "
                        >
                          {{ "Vehicle off the platform" | translate }}
                        </p>
                      </div>
                    </div>
                    <div
                      class="col-lg-12 col-md-12 col-12"
                      *ngIf="
                        expertReviewDetail?.order_id ||
                        expertReviewDetail?.vehicle_information?.is_insider ==
                          true
                      "
                    >
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Images" | translate }}</label
                        >
                        <div class="d-flex">
                          <div
                            class="vehicle-image-wrp me-4"
                            *ngFor="
                              let image of expertReviewDetail
                                .vehicle_information.images
                            "
                          >
                            <img [src]="image" width="100%" height="100%" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-12" *ngIf="expertReviewDetail.contact_info">
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="text-primary font-24 mb-2 fw-semibold">
                            {{ "Contact Information" | translate }}
                          </h3>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Full Name" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.contact_info.full_name
                              ? expertReviewDetail.contact_info.full_name
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Cedula ID" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.contact_info.cadula_id
                              ? expertReviewDetail.contact_info.cadula_id
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Email" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.contact_info.email
                              ? expertReviewDetail.contact_info.email
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Mobile Number" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{ expertReviewDetail.contact_info.country_code }}
                          {{
                            expertReviewDetail.contact_info.mobile_no ? expertReviewDetail.contact_info?.mobile_no.replace(
                              expertReviewDetail.contact_info?.country_code,
                              ""
                            ) : ''
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-12 col-sm-12 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Address" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.contact_info.location?.address
                              ? expertReviewDetail.contact_info.location.address
                              : "-"
                          }}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-6">
            <div class="row">
              <div
                class="col-12"
                *ngIf="expertReviewDetail.meetings.length > 0"
              >
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="text-primary font-24 mb-2 fw-semibold">
                            {{ "Meeting Details" | translate }}
                          </h3>
                        </div>
                      </div>
                    </div>
                    <ng-container
                      *ngFor="let meeting of expertReviewDetail.meetings"
                    >
                      <div class="col-lg-6 col-sm-6 col-12">
                        <div class="form-group">
                          <label
                            class="text-primary-light font-14 d-block mb-2"
                            >{{ "Date" | translate }}</label
                          >
                          <p class="text-primary font-18 mb-0 fw-semibold">
                            {{
                              meeting.date
                                ? (meeting.date | date : "dd-MMMM-YYYY")
                                : "-"
                            }}
                          </p>
                        </div>
                      </div>
                      <div class="col-lg-6 col-sm-6 col-12">
                        <div class="form-group">
                          <label
                            class="text-primary-light font-14 d-block mb-2"
                            >{{ "Time" | translate }}</label
                          >
                          <p class="text-primary font-18 mb-0 fw-semibold">
                            {{ meeting.time ? meeting.time : "-" }}
                          </p>
                        </div>
                      </div>
                      <div class="col-lg-6 col-sm-6 col-12">
                        <div class="form-group">
                          <label
                            class="text-primary-light font-14 d-block mb-2"
                            >{{ "Location" | translate }}</label
                          >
                          <p class="text-primary font-18 mb-0 fw-semibold">
                            <!-- {{
                              meeting.location.address
                                ? meeting.location.address.split(",").join(", ")
                                : "-"
                            }} -->
                            {{
                              meeting.location.address
                                ? meeting.location.address
                                : ""
                            }}
                            {{
                              meeting.location.parish && !meeting.location.address?.includes(meeting.location.parish)
                                ? ", " + meeting.location.parish + ", "
                                : ""
                            }}
                            {{
                              meeting.location.city && !meeting.location.address?.includes(meeting.location.city)
                                ? meeting.location.city + ", "
                                : ""
                            }}
                            {{
                              meeting.location.province && !meeting.location.address?.includes(meeting.location.province)
                                ? meeting.location.province
                                : ""
                            }}
                          </p>
                        </div>
                      </div>
                      <div class="col-lg-6 col-sm-6 col-12">
                        <!-- <div class="form-group">
                          <label
                            class="text-primary-light font-14 d-block mb-2"
                          > {{ 'Place Reference' | translate }}</label
                          >
                          <p class="text-primary font-18 mb-0 fw-semibold">
                            {{
                              meeting.location.additional_address
                                ? meeting.location.additional_address
                                    .split(",")
                                    .join(", ")
                                : "-"
                            }}
                          </p>
                        </div> -->
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>

              <div class="col-12" *ngIf="expertReviewDetail.payment">
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="font-24 fw-semibold text-primary mb-4">
                            {{ "Payment Method" | translate }}
                          </h3>
                        </div>
                        <div class="col-6 text-end">
                          <!-- <h4
                                                                *ngIf="orderDetails.payment.status === 'success'"
                                                                class="offer-status py-1 px-2 br-5 accepted fw-regular d-inline-block"
                                                              >
                                                                Paid
                                                              </h4> -->

                          <!-- <h4
                                                                *ngIf="
                                                                  orderDetails.payment.status === 'pending' ||
                                                                  orderDetails.payment.status === 'failed' ||
                                                                  orderDetails.payment.status == null
                                                                "
                                                                class="offer-status py-1 px-2 br-5 in-progress fw-regular d-inline-block label in-progress"
                                                              >
                                                                Pending
                                                              </h4> -->
                        </div>
                      </div>
                    </div>
                    <ng-container>
                      <div class="col-sm-4 col-4">
                        <label
                          class="text-secondary"
                          *ngIf="expertReviewDetail.payment?.method == 'card'"
                          ><img
                            class="me-1"
                            data-cash
                            src="assets/images/card-blue.svg"
                            alt="card"
                          />
                          {{ "Card" | translate }}</label
                        >
                      </div>
                      <div
                        class="col-sm-4 col-4"
                        *ngIf="expertReviewDetail.payment"
                      >
                        <span class="text-primary-light font-16 mx-2 mb-2"
                          >{{ "Amount" | translate }}:</span
                        >
                        <label class="text-secondary"
                          >${{
                            expertReviewDetail.payment.status ? (expertReviewDetail.package_details.package_price | spanishNumber) : ('0' | spanishNumber)
                          }}</label
                        >
                      </div>
                    </ng-container>
                    <!-- </div> -->
                  </div>
                </div>
              </div>

              <div class="col-12" *ngIf="expertReviewDetail.expert_information">
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="text-primary font-24 mb-2 fw-semibold">
                            {{ "Expert Information" | translate }}
                          </h3>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Expert Appraiser" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.expert_information.first_name +
                              " " +
                              expertReviewDetail.expert_information.last_name
                          }}
                        </p>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Location" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.expert_information.location.city
                          }}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div
                class="col-12"
                *ngIf="
                  expertReviewDetail.appraisal_report_status === 'completed'
                "
              >
                <div class="bg-white p-4 br-12 mb-3 pb-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="row align-items-center mb-3">
                        <div class="col-6">
                          <h3 class="text-primary font-24 mb-2 fw-semibold">
                            {{ "Expert Evaluation" | translate }}
                          </h3>
                        </div>
                        <div class="col-6 text-end">
                          <button
                            (click)="viewReport(expertReviewDetail.id)"
                            class="btn primary-btn btn-sm br-12"
                          >
                            {{ "View Appraisal Report" | translate }}
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-6 col-sm-6 col-12">
                      <div class="form-group">
                        <label
                          class="text-primary-light font-14 d-block mb-2"
                          >{{ "Expert Comment" | translate }}</label
                        >
                        <p class="text-primary font-18 mb-0 fw-semibold">
                          {{
                            expertReviewDetail.appraisal_report
                              .additional_criteria
                          }}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="btn-grp mt-3 mb-3 d-flex" *ngIf="expertReviewDetail.appraisal_report_status != 'cancelled'">
          <button
            class="btn primary-btn me-3 btn-lg border-1"
            (click)="continueProcess()"
            *ngIf="currentExpertReviewStep <= expertReviewStepNumber.PAYMENT"
          >
            {{ "Continue Process" | translate }}
          </button>
          <button
            class="btn primary-btn-outline me-3 btn-lg border-1"
            (click)="cancelExpertReview()"
            *ngIf="expertReviewDetail.appraisal_report_status != 'completed'"
          >
            {{ "Cancel Expert Review" | translate }}
          </button>
        </div>
      </div>
    </ng-container>
    <ng-template #loader>
      <app-loader></app-loader>
    </ng-template>
  </div>
</section>
